trigger:
- none

pool: agent1_pool

variables:
  TOMCAT_HOME: /opt/tomcat
  WAR_NAME: JavaLoginShowcase.war

stages:
# =========================
# CI STAGE â€“ BUILD
# =========================
- stage: Build
  jobs:
  - job: BuildWAR
    pool:
      name: agent1_pool
    steps:
    - checkout: self

    - script: |
        echo "Current dir:"
        dir
        mvn help:evaluate -Dexpression=project.packaging -q -DforceStdout
        mvn clean package -DskipTests
      displayName: Maven Build

    - script: |
        echo "Maven target directory:"
        dir target
        displayName: Check target folder

    - script: |
        echo "Searching for WAR..."
        dir /s *.war
      displayName: Find WAR

    - task: PublishBuildArtifacts@1
      inputs:
        PathtoPublish: '**/*.war'
        ArtifactName: drop
